# 생성자에 매개변수가 많다면 빌더를 고려하라

### 생성자와 정적 팩터리는 매개변수가 많을 때 적절히 대응하기 어렵다.

1. 점층적 생성자 패턴(telescoping constructor pattern) : 매개변수를 늘려가며 생성자를 선언하는 방식.
    - 점층적 생성자 패턴도 사용은 가능하지만, 매개변수가 많아지면 **코드를 작성하거나 읽기 어렵다.**

2. 자바빈즈 패턴(JavaBeans pattern) : 매개변수가 없는 생성자로 객체를 만든 후, `setter`메서드들을 호출해 원하는 매개변수의 값을 설정하는 방식.
    - **치명적인 단점** : 객체 하나를 만들려면 메서드를 여러 개 호출해야 한다. 
    - 객체가 완전히 생성되기 전까지는 일관성이 무너진 상태에 놓이게 된다.
    - 일관성이 무너지기 때문에 클래스를 불변으로 만들 수 없다.

3. 빌더 패턴(Builder pattern) : **점층적 생성자 패턴의 안전성 + 자바빈즈 패턴의 가독성**
    - 필요한 객체를 직접 만드는 대신, 필수 매개변수만으로 생성자(혹은 정적 팩터리)를 호출해 빌더 객체를 얻는다. 
    - 그 다음 빌더 객체가 제공하는 일종의 세터 메서드들로 원하는 선택 매개변수들을 설정한다.
    - 마지막으로 매개변수가 없는 build 메서드를 호출해 필요한 객체를 얻는다.

- 빌더의 메서드는 자신을 반환하기 때문에 연쇄적으로 호출이 가능하다. 이런 방식을 **플루언트API** 혹은 **메서드 연쇄**라 한다.
- 빌더 패턴은 계층적으로 설계된 클래스와 함께 쓰기에 좋다. 각 계층의 클래스에 관련 빌더를 멤버로 정의하고 추상 클래스는 추상 빌더를 구체 클래스는 구체 빌더를 갖게 한다.
- 빌더 패턴은 상당히 유연하다. 빌더 하나로 여러 객체를 순회하면서 만들 수 있고 빌더에 넘기는 매개변수에 따라 다른 객체를 만들 수도 있다.


---
### 빌더 패턴의 단점 
1. 객체를 만들려면 빌더부터 만들어야 한다. 
2. 빌더 생성 비용이 크지는 않지만 성능에 민감한 상황에서는 문제가 될 수 있다. 
3. 매개변수가 4개는 넘어야 값어치를 한다.
