# 타입 안전 이종 컨테이너를 고려하라.

타입 안전 이종 컨테이너란?  
컨테이너란 다른 객체를 넣을 수 있는 또 다른 객체이다.  
ex) Map, Set, Optional  

앞 내용에서 살펴본 제네릭을 사용하는 방식은 오로지 한가지 타입을 넣을 수 있는 컨테이너를 만드는 것이었다.
``` java
public class Favorites<T> {
    
    List<T> value;
    
    public static void main(String[] args) {
        Favorites<String> names = new Favorites<>();
        names.value.add("whiteship");
        //names.value.add(1);   // 오류가 발생한다.
    }
    
}
```

경우에 따라서는 같은 타입이 아닌 데이터를 넣어야 하는 경우가 있고, 이러한 컨테이너를 이종 컨테이너라고한다.

## 타입 안전하지 않은 이종 컨테이너
``` java
public class Favorites {
    
    private Map<Class, Object> map = new HashMap<>();
    
    public void put(Class cl, Object val) {
        this.map.put(cl, val);
    }
    
    public Object get(Class cl) {
        return this.map.get(cl);
    } 
    
    public static void main(String[] args) {
        Favorite favorites = new Favorites();
        
        // 타입 안전하지 않다.
        favorites.put(String.class, 1);
        
        favorites.put(String.class, "jaein");
        
        // 타입 안전하지 않다.
        favorites.put(Integer.class, "jaein");
        
        favorites.put(Integer.class, 2);
        
    }
    
}
```
타입 안전하기 위해 컨테이너(Map)에 타입을 선언하는게 아니라 키(Class)에 해당하는 곳에 타입을 선언해야한다.
## 타입 안전 이종 컨테이너
``` java
public class Favorites {
    
    private Map<Class<?>, Object> map = new HashMap<>();
    
    // <T> 는 클래스 리터럴
    public <T> void put(Class<T> cl, T val) {
        // requireNonNull() 메소드에서 NullPointerException 검사를 해준다.
        this.map.put(Objects.requireNonNull(cl), val);
    }
    
    public <T> get(Class<T> cl) {
        // cast() 메소드에서 ClassCastException 검사를 해준다.
        return cl.cast(this.map.get(cl));
    } 
    
    public static void main(String[] args) {
        Favorite favorites = new Favorites();
        
        // 컴파일 오류가 난다.
        // favorites.put(String.class, 1);
        
        favorites.put(String.class, "jaein");
        
        // 컴파일 오류가 난다.
        // favorites.put(Integer.class, "jaein");
        
        favorites.put(Integer.class, 2);
        
        Integer integer = favorites.get(String.class)
        
    }
    
}
```