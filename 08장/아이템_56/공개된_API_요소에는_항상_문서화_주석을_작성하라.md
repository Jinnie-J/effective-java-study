# 공개된 API 요소에는 항상 문서화 주석을 작성하라

전통적으로 API 문서는 사람이 직접 작성하므로 코드가 변경되면 매번 수정해줘야 하는데, 자바에서는 `Javadoc`이라는 유틸리티가 이 귀찮은 작업을 도와준다.

## Javadoc
소스코드 파일에서 문서화 주석(doc comment)이라는 특수한 형태로 기술된 설명을 추려 API 문서로 변환해주는 유틸리티이다.
> https://docs.oracle.com/javase/8/docs/technotes/tools/windows/javadoc.html

## API를 올바르게 문서화하기 위한 방법
### 공개된 모든 클래스, 인터페이스, 메서드, 필드 선언에 문서화 주석을 달아야 한다. 
문서화 주석이 없다면 `Javadoc`도 그저 공개 API 요소들의 선언만 나열해주는 게 전부다.

기본 생성자는 주석을 달 방법이 없기 때문에 공개 클래스는 절대 기본 생성자를 사용하면 안된다.  
또한 유지보수까지 고려한다면 대다수의 공개되지 않은 대상들에도 공개 API만큼 친절하게는 아니지만, 문서화 주석을 달아야 할 수 있다.
### 메서드용 문서화 주석에는 해당 메서드와 클라이언트 사이의 규약을 명료하게 기술해야 한다.
상속용으로 설계된 클래스의 메서드가 아니라면 그 메서드가 **어떻게** 동작하는지가 아니라 **무엇을** 하는지 작성해야 한다.

클라이언트는 내부가 어떻게 돌아가는지가 궁금한게 아니라 무엇을 하고 어떤 결과를 반환할지가 궁금할 것이다.  

#### 📍 문서화해야하는 요소
- **클라이언트가 해당 메서드를 호출하기 위한 전제조건**
  - 일반적으로 `@throws` 태그로 비검사 예외를 선언하여 암시적으로 기술한다.
  - `@param` 태그를 이용해 그 조건에 영향받는 매개변수에 기술할 수도 있다.
- **메서드가 성공적으로 수행된 후에 만족해야 하는 사후조건**
- **부작용**
  - 사후조건으로 명확히 나타나지는 않지만, 시스템의 상태 변화를 가져오는 것  
    (ex. 백그라운드 스레드를 시작시키는 메서드라면 그 사실을 문서에 작성해야 한다.)
## 문서화 주석 작성법
- (매개변수가 있다면) `@param` 태그로 매개변수에 대해 명사구로 작성한다.
- (반환 타입이 void가 아니라면) `@return` 태그로 반환 타입에 대해 명사구로 작성한다.
  - 해당 태그의 설명과 메서드의 설명이 같은 경우 생략이 가능하다.
- 모든 예외는 `@throws` 태그로 예외와 예외 발생조건에 대해 기술한다.
- 관례상 `@param`,`@return`, `@throws` 태그의 설명에는 마침표를 붙이지 않는다.
```java
/**
 * 이 리스트에서 지정한 위치의 원소를 반환한다.
 * 
 * <p>이 메서드는 상수 시간에 수행됨을 보장하지 <i>않는다</i>. 구현에 따라
 * 원소 위치에 비례해 시간이 걸릴 수도 있다.
 * 
 * @param  index 반환할 원소의 인덱스; 0 이상이고 리스트 크기보다 작아야 한다.
 * @return 이 리스트에서 지정한 위치의 원소
 * @throws IndexOutOfBoundsException index가 범위를 벗어나면,
 *         즉, ({@code index < 0 || index >= this.size()})이면 발생한다.
 */
```
- 상속용으로 설계된 클래스에서는 자기사용 패턴(self-use pattern)에 대해서도 문서에 남겨 다른 프로그래머에게 그 메서드를 올바르게 재정의하는 방법을 알려줘야 한다.
  - 자기사용 패턴은 자바 8에 추가된 `@implSpec` 태그로 문서화한다.
  - 일반적인 문서화 주석은 해당 메서드와 클라이언트 사이의 계약을 설명하지만,   
    `@implSpec` 주석은 해당 메서드와 하위 클래스 사이의 계약을 설명한다.
  - Java 11까지 열거 타입 자체와 그 열거 타입의 public 메서드 명령줄에서 다음 옵션을 넣지 않으면 `@implSpec` 태그는 무시된다.
    - `-tag "implSpec:a:Implementation Requirements:"`
  ```java
  /**
   * 이 컬렉션이 비었다면 true를 반환한다.
   * 
   * @implSpec 
   * 이 구현은 {@code this.size() == 0}의 결과를 반환한다.
   * 
   * @return 이 컬렉션이 비었다면 true, 그렇지 않으면 false
   */
  public boolean isEmpty() { ... }
  ```
- HTML 메타 문자(<,>,& 등)를 사용하고 싶다면 `{@literal}` 태그로 감싸면 된다.
  - 아래 주석은 "|r| < 1이면 기하 수열이 수렴한다."로 변환된다.
  ```java
  * {@literal |r| < 1}이면 기하 수열이 수렴한다.
  ```
  - 각 문서화 주석의 첫 번째 문장은 해당 요소의 요약 설명(summary description)으로 간주되며, 기능을 **고유하게** 기술해야 한다.
    - 한 클래스(혹은 인터페이스) 안에서 요약 설명이 똑같은 멤버(혹은 생성자)가 둘 이상이면 안 된다.
    - 다중정의된 메서드도 첫 번째 문장이 같아서는 안 된다.
    - 첫 문장은 마침표(.)까지이므로 첫 번째 마침표(.) 기술 시 주의해야 한다.
       ```java
       /**
        * 머스타드 대령이나 {@literal Mrs. 피콕} 같은 용의자.
        */
       public class Suspect { ... }
      ```
    - `메서드`와 `생성자`의 요약 설명은 해당 메서드와 생성자의 동작을 설명하는 (주어가 없는) 동사구여야한다.
    - `클래스`, `인터페이스`, `필드`의 요약 설명은 대상을 설명하는 명사절이어야 한다.
    - 이번 아이템 첫 예시의 "이 리스트에서 지정한 위치의 원소를 반환한다."라는 문장이 여기에 속한다.

## 그 밖에 문서화 주석을 작성해야 하는 경우
### 열거 타입
열거 타입을 문서화할 때는 열거 타입 자체와 그 열거 타입의 public 메서드뿐만 아니라 상수들에도 주석을 달아야 한다.
```java
/**
 * 심포니 오케스트라의 악기 세션
 */
public enum OrchestraSection {
    /** 플루트, 클라리넷, 오보에 같은 목관악기. */
    WOODWIND,

    /** 프렌치 호른, 트럼펫과 같은 금관악기. */
    BRASS,

    /** 팀파니, 심벌즈 같은 타악기. */
    PERCUSSION,
  
    /** 바이올린, 첼로 같은 현악기. */
    STRING;
}
```
### 애너테이션
애너테이션 타입을 문서화할 때는 애너테이션 타입 자체는 물론이고, 멤버들에도 모두 주석을 달아야 한다.  
```java
/**
 * 이 애너테이션이 달린 메서드는 명시한 예외를 던져야만 성공하는
 * 테스트 메서드임을 나타낸다.
 */
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface ExceptionTest {
    /**
     * 이 애너테이션을 단 테스트 메서드가 성공하려면 던져야 하는 예외.
     * (이 클래스의 하위 타입 예외는 모두 허용된다.)
     */
    Class <? extends Throwable> value();
}
```
### 패키지(그리고 모듈)
패키지를 설명하는 문서화 주석은 package-info.java 파일에 작성한다.  
자바 9부터 지원하는 모듈 시스템(아이템 15)도 이와 비슷하게 module-info.java 파일에 작성하면 된다.

## 자주 누락되는 설명들
API 문서화에서 자주 누락되는 두 가지 설명은 **스레드 안전성**과 **직렬화 가능성**이다.
### 스레드 안전성
클래스 혹은 정적 메서드가 스레드 안전하든 그렇지 않든, 스레드 안전 수준을 반드시 API 설명에 초함해야 한다.(아이템 82)  
### 직렬화 가능성
직렬화할 수 있는 클래스라면 직렬화 형태도 API 설명에 기술해야 한다.(아이템 87)

## 메서드 주석의 상속기능
`Javadoc`은 메서드 주석을 상속시킬 수 있다.  
주석이 없는 API 요소를 발견하면, 상위 클래스보다 그 클래스가 구현한 인터페이스를 먼저 찾아 가장 가까운 문서화 주석을 찾아준다.  
또한 {@inheritDoc} 태그를 이용해 상위 타입의 문서화 주석 일부를 상속할 수도 있다.  
이 기능은 유지보수 시 부담을 줄일 수 있지만, 사용하기가 까다롭고 제약이 있어 사용이 조심스럽다.

## 결론
문서화 주석은 여러분 API를 문서화하는 가장 효과적인 방법이다.  
공개 API라면 빠짐없이 설명을 달아야 하며, 표준 규약을 일관되게 지키자.  
문서화 주석에 임의의 HTML 태그를 사용할 수 있지만, HTML 메타문자는 특별하게 취급해야 함을 잊지 말자.

## 참조
- https://catsbi.oopy.io/1b439cd5-58aa-4cb1-a715-2bfa66afc72a
